## 1. 项目开发 
- **用户请求**: 请帮我分析项目1的要求
- **AI 操作**:
  - 一、 项目1 核心要求分析项目1 要求开发一个三层架构的多文档界面（MDI）记事本 2。1. 核心功能需求基础框架：基于 CMultiDocTemplate 实现多文档管理，不准直接使用 CEditView，必须使用 CView 或 CScrollView 33。+3编辑功能：支持撤销/重做、正则搜索/替换、行号显示 4。文件格式：支持纯文本 (*.txt) 和自定义富文本 (*.mynote) 5。视觉效果：支持暗/亮两套主题切换 6。代码质量：使用 RAII 包装文件操作，单元测试覆盖率需 $\ge 70\%$ 7。2. 特殊“抗 AI”与合规需求（关键）自定义文件头：*.mynote 文件头必须包含您的学号 8。加密校验：文档末尾必须附加 AES-CBC 加密的 SHA-1 摘要 9。AI 使用规范：必须记录 AI 使用日志（Prompt、Response、Diff），严禁直接复制 AI 生成的占位符（如 <STUDENT_ID>） 1010101010。+4二、 逐步实施指南第一步：搭建 MDI 基础架构在 Visual Studio 中创建 MFC 应用，选择“多文档（MDI）”和“文档/视图结构支持”。类选择：基类选择 CView 11。核心配置：在 InitInstance 中配置 CMultiDocTemplate 12。日志初始化：创建 docs/ai_logs/ 目录，准备记录您的第一次 AI 对话 13。第二步：实现自定义视图与编辑逻辑由于禁止使用 CEditView，您需要自己管理文本数据。数据存储：在 CDocument 子类中存储字符串数据。绘制逻辑：在 OnDraw 中处理文本显示和行号绘制 1414。+3命令模式：建议引入 Command 模式处理“撤销/重做”功能，以符合架构设计要求 151515。+4第三步：文件 I/O 与安全校验（核心代码点）您需要编写处理 *.mynote 的逻辑。以下是符合要求的架构思路：RAII 包装：创建一个类专门管理 CFile 的生命周期 16。加密流程：计算全文的 SHA-1 摘要。使用您的 SECRET_KEY 进行 AES-CBC 加密。将学号写入文件头，加密摘要写入文件末尾 17。第四步：主题切换与单元测试主题管理：定义两套颜色配置方案（暗/亮），并在视图重绘时应用 18。测试驱动：使用 GoogleTest 针对文件读写、主题切换算法编写测试用例，确保覆盖率 19。
  ## 2. 错误查改 
- **用户请求**: 把第三步代码后有一个错误，如图。
- **AI 操作**:
  - 解决 E0135 报错（完善 Doc 类）
你需要打开 MDI_Notepad_Project1Doc.h，在类定义中手动添加成员变量。
文件位置：MDI_Notepad_Project1Doc.h
修改内容：在 Attributes 模块下添加 m_strContent。
根据项目要求，RAII 包装用于处理 CFile 的安全操作 。为了保证代码架构清晰，建议按以下方式存放：
A. 创建专门的工具头文件 (推荐)
在 Visual Studio 右侧“解决方案资源管理器”中，右键点击“头文件”文件夹。
选择 添加 -> 新建项，创建一个名为 FileHelper.h 的头文件。
B. 在 Doc 类中使用该包装器
当你需要实现文件保存逻辑时，在 MDI_Notepad_Project1Doc.cpp 顶部 #include "FileHelper.h"，然后在函数内部调用它。
 下一步建议：实现抗 AI 需求
修复报错后，你的下一步任务是处理 “抗 AI 需求”，这在评估标准中占比 30% ：
学号文件头：在保存时先写入你的真实学号 。
AES-CBC 加密：在文档末尾附加 SHA-1 摘要 。
日志记录：记得将你修复这个报错的过程记录在 docs/ai_logs/ 的 Markdown 日志中，这是目标 3 的考核内容 。
## 3. 功能开发 
- **用户请求**: 手动填入 IV是账号的意思吗
- **AI 操作**:
  - 在加密技术的语境下，你的理解稍微有些偏差。在项目 1 的抗 AI 需求中，密钥（Key）和 IV 是加密算法（AES-CBC）的两个核心参数，而不是日常使用的“账号和密码” 。
以下是详细的解释：
1. 密钥（Key） vs 密
密钥（Key）：在代码里，它是用来对数据进行加密和解密的“钥匙” 。虽然它的作用类似于密码，但在 AES 加密中，它通常是一串固定长度的字符（如 16、24 或 32 字节）。
为什么项目要求手动填入：为了防止 AI 直接生成通用的作业答案 。通过要求你填入自定义的密钥，老师可以确保每个学生的加密结果是唯一的 。
2. IV（初始化向量）是什么？
IV（Initialization Vector）：它不是账号。它的作用是为加密过程引入随机性
作用：即使你保存了两次完全一样的文本内容，只要 IV 不同，加密出来的密文也会完全不同。这可以防止黑客通过模式分析破解你的文件。
在项目中的位置：你需要手动替换占位符 <IV> 处的一串字符 。
## 4. 功能开发 
- **用户请求**: 现在已经可以正常运行了，如图，接下来怎么继续完成项目要求
- **AI 操作**:
  - 太棒了！看到你的程序成功运行并出现了多文档界面，说明你已经完成了维度 1：架构应用中最难的搭建工作 。
接下来，我们需要根据项目需求完成编辑功能 (F-03) 和 主题切换 (F-04) 。由于你使用的是 CView 而非 CEditView ，你现在看到的是一片空白。
你需要处理的核心文件是：
MDI_Notepad_Project1View.h：声明键盘监听函数和字体变量。
MDI_Notepad_Project1View.cpp：编写文字输入、显示和背景颜色逻辑。